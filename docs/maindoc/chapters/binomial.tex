\chapter{Simulation: Binomial Scenarios}
\section{Introduction}
This scenario models an enviroment where users have a fixed position in the space. There are some users which receive stronger signal from antenna, so they have an higher mean CQI, and others which are far from antenna and then they have smaller mean CQI. The requirements state that the distribution of CQIs must have a binomial distribution. To satisfy these, at each timeslot \(t_{j}\), every \texttt{Mobile Station} \(i\) generates a RV \(X_{i,t_{j}} \sim Bin(14,p_{i})\), and then \(CQI_{i,t_{j}} = X + 1\). By using this trick \(CQI_{i,t_{j}} \in \{1,15\}\) and it has a binomial distribution. In order to have different mean we have chose this values for parameters \(p_{i}\).
\begin{lstlisting}[caption={omnet.ini - p parameters}]
	CellularNetwork.users[0].cqi_binomial_p = 0.13
	CellularNetwork.users[1].cqi_binomial_p = 0.22
	CellularNetwork.users[2].cqi_binomial_p = 0.31
	CellularNetwork.users[3].cqi_binomial_p = 0.40
	CellularNetwork.users[4].cqi_binomial_p = 0.49
	CellularNetwork.users[5].cqi_binomial_p = 0.58
	CellularNetwork.users[6].cqi_binomial_p = 0.67
	CellularNetwork.users[7].cqi_binomial_p = 0.76
	CellularNetwork.users[8].cqi_binomial_p = 0.85
	CellularNetwork.users[9].cqi_binomial_p = 0.94
\end{lstlisting}
As in the previous scenario we will analyze the performance about throughput and response time by using both scheduler. Before doing simulation we can do some conjectures. Note that in this scenario mean CQI are sensibly different so we expect that \(user[9]\), that has highest probability to generate high CQI, and it will have highest throughput. Morover we can suppose that it will take advantage of Best CQI policy and will increase its throughput despite other users. Otherwise \(user[0]\), which has lower mean CQI, we can suppose it will decrease its throughput when it is used the Best CQI Scheduler.

\begin{itemize}
	\item \(n=10\)
	\item \(packetsize_{i} \sim U(3,75), \quad 0 \le i \le n-1\)
	\item \(CQI_{i} \sim Bin(14,p_{i})+1, \quad 0 \le i \le n-1\)
	\item \( \lambda = \lambda_{i} = 0.1 + 0.5k, \quad k\in\{1,2\ldots,19\}, \quad 0 \le i \le n-1\)
\end{itemize}

\section{Binomial, Fair Scheduler}
In this scenario the scheduler is the basic Round Robin scheduler.

\begin{figure}[H]
  \includegraphics[width=1\textwidth]{images/binom}
  \caption{Binomial scenario - Fair: throughput, response time}
  \label{fig:Binomial scenario - Fair: throughput, response time}
\end{figure}
Users have very different throughput as we expected. When \( 0 < \lambda \leq 1\), all users have the same throughput because the traffic is very low and the resources provided by the frame are quite enough to satisfy all users. However this is a very special case, we can see that as \(\lambda\) increases users having lower mean CQIs saturate. The scheduler is always fair but users with higher mean CQIs have bigger RBs inside the frame that can carry more data. Saturation points follow the distribution of CQIs among users, so users with lower CQI, on average, saturate before, otherwise users with higher CQI exploit better the frame and saturate with higher \(\lambda\) rate. 
By analyzing the throughput plot we observe that users have a small peak near the saturation point and then their throughput decrease and approches to an horizontal line. The explaination is quite easy. If \(\lambda\) rate is \textit{small} users with higher mean CQI use few RBs to empty their queue, so the frame filling algorithm has free RBs to distribute among other users. When \(\lambda\) rate becomes \textit{high} also users with higher mean CQI require the lots of RBs and the effect of frame fill is limited. 

Note that the frame filling policy can have a strong impact on the throughput. Let's consider, for example, a very simple rule: 
\begin{itemize}
\item The residual space in the frame is filled by considering the user \(j\), where \(j = (currentUser+1) \textnormal{mod n} n\).
\end{itemize}
\begin{figure}[H]
  \includegraphics[width=1\textwidth]{images/binom_old}
  \caption{Binomial scenario - Simple: throughput, response time}
  \label{fig:Binomial scenario - Simple: throughput, response time}
\end{figure}
If we consider the \texttt{user[0]} we can notice a very strange behavior. When \(0 < \lambda \leq 1.5\) it has higher throughput and smaller response time than \texttt{user[1]} and \texttt{user[2]} and this seems senseless because \texttt{user[0} has smaller mean CQI. However this odditity can be explained by observing that, in that range of traffic, \texttt{user[9]} requires a low number of RBs but the frame must be filled and the simple rule \textbf{always} choses the next user wich is \texttt{user[0]}. When \(\lambda\) increases \texttt{user[9]} requires more RBs, and the throughput of \texttt{user[0]} decreases.

Saturation point are different for each user.
\begin{center}
	\begin{tabular}{|c | c | c|}
	\hline
	 \textbf{user}  & \textbf{\(\lambda_{sat}\)}  & \textbf{throghput [bps]} \\ \hline
	 0 & 1.1 & $342855 \pm 1027$ \\ \hline
	 1 & 1.6 & $499558 \pm 1057$\\ \hline
	 2 & 2.1 & $652748 \pm 2600$\\ \hline
	 3 & 2.6 & $767444 \pm 3177$\\ \hline
	 4 & 3.1 & $913755 \pm 4954$\\ \hline
	 5 & 3.6 & $1093554 \pm 5318$\\ \hline
	 6 & 4.1 & $1279993 \pm 3140$\\ \hline
	 7 & 4.6 & $1434389 \pm 1780$ \\ \hline
	 8 & 5.6 & $1726384 \pm 2218$ \\ \hline
	 9 & 6.1 & $1904459 \pm 1880$ \\ \hline
	\end{tabular}
\end{center}